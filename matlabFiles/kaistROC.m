%% KAIST set
%% PSM K = 1

TN = 8313;

FP1=18/TN;TPR1=0.07393;
FP5=91/TN;TPR5=0.23476;
FP10=91/TN;TPR10=0.249027;
FP15=91/TN;TPR15=0.249027;
FP50=91/TN;TPR50=0.249027;

x1= [ 0 TPR1 TPR5 TPR10 TPR15 TPR50 TPR50 TPR50];
y1= [ 0 FP1 FP5 FP10 FP15 FP50 FP50 FP50];

plot(y1,x1)

%% K = 2
TN = 7903;

FP1=45/TN;TPR1=0.12192;
FP5=204/TN;TPR5=0.289235;
FP10=204/TN;TPR10=0.293126;
FP50=204/TN;TPR50=0.294423;
FP100=204/TN;TPR100=0.294423;
FP1000=204/TN;TPR1000=0.294423;

x2 = [0 TPR1 TPR5 TPR10 TPR50 TPR100 TPR1000 TPR1000 TPR1000];
y2 = [0 FP1 FP5 FP10 FP50 FP100 FP1000 FP1000 FP1000];

plot(y2,x2)
%% K = 3

TN =7921;

FP1=42/TN;TPR1=0.119326;
FP5=169/TN;TPR5=0.303502;
FP10=169/TN;TPR10=0.304799;
FP50=169/TN;TPR50=0.306096;
FP100=169/TN;TPR100=0.306096;
FP1000=169/TN;TPR1000=0.306096;

x3 = [ 0 TPR1 TPR5 TPR10 TPR50 TPR100 TPR1000 TPR1000 TPR1000]; 
y3 = [ 0 FP1 FP5 FP10 FP50 FP100 FP1000 FP1000 FP1000];
%%
plot(y1,x1,y2,x2,y3,x3,[0 0.05],[0 0.05],'k-','LineWidth',3)
ylabel('True Positive Rate(Sensitivity)');
xlabel('False Positive Rate(Specificity)');
legend('K = 1', 'K = 2', 'K = 3', 'Diagonal');
title('PSM - KAIST dataset');
grid on

%% Img difference K = 1 T = 30.46 without MRF

TN =5857;

%% Feature grouping K = 1

TN = 4945;

FP1=2448/TN;TPR1=0.571145;
FP2=3409/TN;TPR2=0.626075;
FP3=3525/TN;TPR3=0.639974;
FP4=3562/TN;TPR4=0.644606;
FP5=3570/TN;TPR5=0.647253;
FP6=3574/TN;TPR6=0.649901;
FP7=3574/TN;TPR7=0.650563;
FP8=3576/TN;TPR8=0.651224;
FP9=3576/TN;TPR9=0.651224;
FP10=3576/TN;TPR10=0.651886;
FP11=3576/TN;TPR11=0.651886;
FP12=3576/TN;TPR12=0.651886;
FP13=3576/TN;TPR13=0.651886;
FP14=3576/TN;TPR14=0.651886;
FP15=3576/TN;TPR15=0.651886;


x1 = [0 TPR1 TPR2 TPR3 TPR4 TPR5 TPR6 TPR7 TPR8 TPR9 TPR10 TPR11 TPR12 TPR13 TPR14 TPR15];
y1 = [0 FP1 FP2 FP3 FP4 FP5 FP6 FP7 FP8 FP9 FP10 FP11 FP12 FP13 FP14 FP15];

plot(y1,x1)

%% K = 2
TN = 4270;

FP0_1=42/TN;TPR0_1=0.00661813;
FP0_2=674/TN;TPR0_2=0.099272;
FP0_3=1232/TN;TPR0_3=0.225017;
FP0_4=2316/TN;TPR0_4=0.321641;
FP0_5=2900/TN;TPR0_5=0.385837;
FP0_6=3077/TN;TPR0_6=0.389808;
FP0_7=3770/TN;TPR0_7=0.409001;
FP0_8=3870/TN;TPR0_8=0.418928;
FP0_9=3905/TN;TPR0_9=0.420913;
FP0_95=3905/TN;TPR0_95=0.420913;

x2 = [0 TPR0_1 TPR0_2 TPR0_3 TPR0_4 TPR0_5 TPR0_6 TPR0_7 TPR0_8 TPR0_9 TPR0_95];
y2 = [0 FP0_1 FP0_2 FP0_3 FP0_4 FP0_5 FP0_6 FP0_7 FP0_8 FP0_9 FP0_95];

plot(y2,x2)
%% K = 3
TN = 3630;

FP0_1=708/TN;TPR0_1=0.0330907;
FP0_15=1490/TN;TPR0_15=0.10589;
FP0_2=2265/TN;TPR0_2=0.201853;
FP0_25=3161/TN;TPR0_25=0.251489;
FP0_3=3511/TN;TPR0_3=0.311714;

x3 = [0 TPR0_1 TPR0_15 TPR0_2 TPR0_25 TPR0_3];
y3 = [0 FP0_1 FP0_15 FP0_2 FP0_25 FP0_3];

%%
plot(y1,x1,y2,x2,y3,x3,[0 1],[0 1],'k-','LineWidth',3)
ylabel('True Positive Rate(Sensitivity)');
xlabel('False Positive Rate(Specificity)');
legend('K = 1', 'K = 2', 'K = 3', 'Diagonal');
title('Feature grouping - KAIST dataset');
grid on

%% 44 images
tgk1 = 8.37;
tgk2 = 8.5;
tgk2 = 8.5;

tik1 = 37.15;
tik2 = 67.1;
tik3 = 92.25;
